(self.webpackChunkmps=self.webpackChunkmps||[]).push([[931],{8931:(N,j,M)=>{"use strict";M.r(j),M.d(j,{MapModule:()=>ct});var O=M(6895),E=M(9030),A=M(8407),t=(M(4930),M(4395),M(4650)),o=M(6319),a=M(4006),d=M(4144),s=M(9549),m=M(4859);let u=(()=>{class r{constructor(e){this.data=e,this.formBuilder=(0,t.f3M)(a.j3),this.form=this.formBuilder.group({number:this.data.number,lat:this.data.lat,lng:this.data.lng,height:this.data.height})}get point(){return{number:this.data.number,lat:this.form.controls.lat.value,lng:this.form.controls.lng.value,height:this.form.controls.height.value}}ngOnInit(){this.form.controls.number.disable()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(o.WI))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-point-dialog"]],decls:23,vars:2,consts:[["mat-dialog-content",""],[3,"formGroup"],["appearance","fill"],["formControlName","number","matInput",""],["formControlName","lat","matInput","","type","number","step","0.000001"],["formControlName","lng","matInput","","type","number","step","0.000001"],["formControlName","height","matInput","","type","number","step","1"],["mat-dialog-actions","",1,"actions"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-button","",3,"mat-dialog-close"]],template:function(e,c){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Number"),t.qZA(),t._UZ(5,"input",3),t.qZA(),t.TgZ(6,"mat-form-field",2)(7,"mat-label"),t._uU(8,"LAT"),t.qZA(),t._UZ(9,"input",4),t.qZA(),t.TgZ(10,"mat-form-field",2)(11,"mat-label"),t._uU(12,"LNG"),t.qZA(),t._UZ(13,"input",5),t.qZA(),t.TgZ(14,"mat-form-field",2)(15,"mat-label"),t._uU(16,"HEIGHT"),t.qZA(),t._UZ(17,"input",6),t.qZA()()(),t.TgZ(18,"div",7)(19,"button",8),t._uU(20,"CLOSE"),t.qZA(),t.TgZ(21,"button",9),t._uU(22,"SAVE"),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("formGroup",c.form),t.xp6(20),t.Q6J("mat-dialog-close",c.point))},dependencies:[a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,d.Nt,s.KE,s.hX,o.ZT,o.xY,o.H8,m.lW],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}"]}),r})();var p=M(1135),v=M(9646);let g=(()=>{class r{constructor(){this.points=[{number:1,lat:50.486375,lng:30.469851,height:100},{number:2,lat:50.487071,lng:30.470656,height:100},{number:3,lat:50.486108,lng:30.472308,height:100},{number:4,lat:50.486508,lng:30.472308,height:100}]}getPoints(){return(0,v.of)(this.points)}postPoints(e){console.log(e)}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var b=M(580),C=M(3336),y=M(3238);const k=["*"],z=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],V=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],$=new t.OlP("MAT_CARD_CONFIG");let x=(()=>{class r{constructor(e){this.appearance=e?.appearance||"raised"}}return r.\u0275fac=function(e){return new(e||r)(t.Y36($,8))},r.\u0275cmp=t.Xpm({type:r,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(e,c){2&e&&t.ekj("mat-mdc-card-outlined","outlined"===c.appearance)("mdc-card--outlined","outlined"===c.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:k,decls:1,vars:0,template:function(e,c){1&e&&(t.F$t(),t.Hsn(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mat-mdc-card{position:relative;border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px));background-color:var(--mdc-elevated-card-container-color, transparent);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color, transparent)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width, 1px);border-style:solid;border-color:var(--mdc-outlined-card-outline-color, transparent)}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),r})(),F=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275dir=t.lG2({type:r,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]}),r})(),R=(()=>{class r{constructor(){this.align="start"}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275dir=t.lG2({type:r,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(e,c){2&e&&t.ekj("mat-mdc-card-actions-align-end","end"===c.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),r})(),U=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:V,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(e,c){1&e&&(t.F$t(z),t.Hsn(0),t.TgZ(1,"div",0),t.Hsn(2,1),t.qZA(),t.Hsn(3,2))},encapsulation:2,changeDetection:0}),r})(),W=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[y.BQ,O.ez,y.BQ]}),r})();const Q=["aside"];function nt(r,l){if(1&r){const e=t.EpF();t.TgZ(0,"li",7)(1,"mat-card")(2,"mat-card-header",8)(3,"mat-card-subtitle",9)(4,"div",10),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.qZA()()(),t.TgZ(12,"mat-card-actions",11)(13,"button",12),t.NdJ("click",function(){const w=t.CHM(e).$implicit,S=t.oxw();return t.KtG(S.openDialog(w))}),t._uU(14,"EDIT"),t.qZA(),t.TgZ(15,"button",12),t.NdJ("click",function(){const w=t.CHM(e).index,S=t.oxw();return t.KtG(S.deletePoint(w))}),t._uU(16,"DELETE"),t.qZA()()()()}if(2&r){const e=l.$implicit;t.xp6(5),t.Oqu(e.number),t.xp6(2),t.hij("LNG: ",e.lng,";"),t.xp6(2),t.hij("LAT: ",e.lat,";"),t.xp6(2),t.hij("HGT: ",e.height,";")}}const it=function(r){return{height:r}},at=[{path:"",component:(()=>{class r{constructor(e,c,f){this.zone=e,this.pointsService=c,this.dialog=f,this.isAsideOpened=!1,this.points$=new p.X([]),this.markers=[],this.leafletOptions={layers:[(0,A.tileLayer)("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:"..."})],zoom:17,center:(0,A.latLng)(50.4851493,30.4721233)}}get scrollHeight(){return`${document.body.scrollHeight}px`}ngOnInit(){this.pointsService.getPoints().pipe().subscribe(e=>{this.points$.next(e)})}onLeafletMapReady(e){this.map=e,this.points$.subscribe(c=>{this.generateScheme(c),this.pointsService.postPoints(c)})}addPoint(){const c=this.points$.value;c.push({number:this.points$.value.length+1,lat:50.4851493,lng:30.4721233,height:100}),this.points$.next(c)}deletePoint(e){const c=this.points$.getValue();c.splice(e,1);for(let w=e;w<c.length;w++)c[w].number=w+1;c.sort((w,S)=>w.number-S.number),this.points$.next(c)}openDialog(e){this.zone.run(()=>{this.dialog.open(u,{data:e}).afterClosed().subscribe(f=>{if(f){const w=this.points$.value.slice();w.forEach(S=>{S.number===f.number&&(S.lat=f.lat,S.lng=f.lng,S.height=f.height)}),this.points$.next(w)}})})}generateScheme(e){this.eraseScheme(),this.drawScheme(e),this.listenScheme()}eraseScheme(){this.deleteAllPolylines(),this.deleteAllMarkers()}listenScheme(){for(const[e,c]of this.markers.entries())c.off("dragend").on("dragend",()=>this.onMarkerDragEnd(c,e)),c.off("dblclick").on("dblclick",()=>this.onMarkerDoubleClick(e))}onMarkerDragEnd(e,c){this.updatePointCoordinates(e.getLatLng(),c)}onMarkerDoubleClick(e){const c=this.points$.value.find(f=>f.number===e+1);c&&this.openDialog(c)}drawPolyline(e,c){const f=A.polyline(e,c);return f.arrowheads({yawn:13,fill:!0,offsets:{end:"10px"}}),f}drawMarker(e,c,f){const w=document.createElement("div");w.className="marker",w.innerText=String(e);const S=A.divIcon({html:w.outerHTML,className:"marker-icon"});return A.marker([c,f],{icon:S,draggable:!0})}deleteAllPolylines(){this.map.eachLayer(e=>{e instanceof A.Polyline&&e.remove()})}deleteAllMarkers(){this.markers=[],this.map.eachLayer(e=>{e instanceof A.Marker&&e.remove()})}updatePointCoordinates(e,c){const f=this.points$.value.find(Z=>Z.number===c+1);if(!f)return;const w={...f,lat:e.lat,lng:e.lng},S=this.points$.value.map(Z=>Z.number===c+1?w:Z);this.points$.next(S)}drawScheme(e){this.drawMarkers(e),this.drawPolylines(e)}drawPolylines(e){this.drawPolyline(function h(r){return r.map(l=>({lat:l.lat,lng:l.lng}))}(e),{color:"red"}).addTo(this.map)}drawMarkers(e){this.markers=e.map(c=>this.drawMarker(c.number,c.lat,c.lng).addTo(this.map))}toggleAside(){this.isAsideOpened=!this.isAsideOpened}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(t.R0b),t.Y36(g),t.Y36(o.uw))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-map"]],viewQuery:function(e,c){if(1&e&&t.Gf(Q,5),2&e){let f;t.iGM(f=t.CRH())&&(c.asideElement=f.first)}},decls:14,vars:8,consts:[[1,"container",3,"ngClass"],["aside",""],["aria-label","Toggle","color","accent","mat-mini-fab","",1,"toggle",3,"click"],["aria-label","Add Point","color","accent","mat-mini-fab","",1,"add-point",3,"click"],[1,"points"],["class","point",4,"ngFor","ngForOf"],["leaflet","",2,"width","100%",3,"leafletOptions","ngStyle","leafletMapReady"],[1,"point"],[1,"header"],[1,"details"],[1,"marker"],[1,"actions"],["mat-button","",3,"click"]],template:function(e,c){1&e&&(t.TgZ(0,"div",0)(1,"aside",null,1)(3,"button",2),t.NdJ("click",function(){return c.toggleAside()}),t.TgZ(4,"mat-icon"),t._uU(5,"menu"),t.qZA()(),t.TgZ(6,"button",3),t.NdJ("click",function(){return c.addPoint()}),t.TgZ(7,"mat-icon"),t._uU(8,"room"),t.qZA()(),t.TgZ(9,"ul",4),t.YNc(10,nt,17,4,"li",5),t.ALo(11,"async"),t.qZA()(),t.TgZ(12,"main")(13,"div",6),t.NdJ("leafletMapReady",function(w){return c.onLeafletMapReady(w)}),t.qZA()()()),2&e&&(t.Q6J("ngClass",c.isAsideOpened?"opened":"closed"),t.xp6(10),t.Q6J("ngForOf",t.lcZ(11,4,c.points$)),t.xp6(3),t.Q6J("leafletOptions",c.leafletOptions)("ngStyle",t.VKq(6,it,c.scrollHeight)))},dependencies:[O.mk,O.sg,O.PC,b.je,m.lW,m.nh,C.Hw,x,R,U,F,O.Ov],styles:[".container[_ngcontent-%COMP%]{display:grid}.container.closed[_ngcontent-%COMP%]{grid-template-columns:0 1fr}.container.closed[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%], .container.closed[_ngcontent-%COMP%]   .add-point[_ngcontent-%COMP%]{left:8px}.container.opened[_ngcontent-%COMP%]{grid-template-columns:215px 1fr}.container.opened[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%], .container.opened[_ngcontent-%COMP%]   .add-point[_ngcontent-%COMP%]{left:196px}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{max-height:100vh;overflow:scroll;background-image:url(https://img.freepik.com/premium-vector/ukraine-camouflage-mm-14-pixel-seamless-military-pattern-texture-olive-colors-abstract-masking_653528-1434.jpg?w=1380);background-repeat:no-repeat;background-size:cover}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{position:absolute;top:97px;z-index:888}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .add-point[_ngcontent-%COMP%]{position:absolute;top:143px;z-index:888}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]{overflow:scroll}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{margin:10px}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:8px 8px 0}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{justify-content:space-evenly}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .points[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:75px}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;height:84px}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}"]}),r})()}];let ot=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[E.Bz.forChild(at),E.Bz]}),r})();var rt=M(1707);M(7340);let dt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[O.ez,y.BQ,rt.ZD,rt.ZD,y.BQ]}),r})(),ct=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[O.ez,ot,b.UO,dt,m.ot,C.Ps,W,o.Is]}),r})()},4395:()=>{function N(i,n){return(i%n+n)%n}function j(i){return Object.fromEntries(Object.entries(i).filter(([n,t])=>void 0!==t))}function M(i){return"m"===i.toString().trim().slice(i.toString().length-1,i.toString().length)}function O(i){return"%"===i.toString().trim().slice(i.toString().length-1,i.toString().length)}function E(i){return"px"===i.toString().trim().slice(i.toString().length-2,i.toString().length)}function A(i,n){let t=n.getCenter(),o=n.latLngToLayerPoint(t),a={x:o.x+Number(i),y:o.y},d=n.layerPointToLatLng(a);return n.distance(t,d)}L.Polyline.include({arrowheads:function(i={}){this.options.noClip=!0;let t=Object.assign({},{yawn:60,size:"15%",frequency:"allvertices",proportionalToTotal:!1},i);return this._arrowheadOptions=t,this._hatsApplied=!0,this},buildVectorHats:function(i){this._arrowheads&&this._arrowheads.remove(),this._ghosts&&this._ghosts.remove();let n=Object.getPrototypeOf(Object.getPrototypeOf(this.options)),t=Object.assign({},n,this.options),o=Object.assign({},t,i);o.smoothFactor=1,o.fillOpacity=1,o.fill=!!i.fill,o.interactive=!1;let a=i.size.toString(),d=[];const{frequency:s,offsets:m}=i;(m?.start||m?.end)&&this._buildGhosts({start:m.start,end:m.end}),(this._ghosts||this)._parts.forEach((h,v)=>{const g=h.map(x=>this._map.layerPointToLatLng(x)),b=(()=>{let x=0;for(var _=0;_<h.length-1;_++)x+=this._map.distance(g[_],g[_+1]);return x})();let C,y,k,T;if(isNaN(s)?O(s)?console.error("Error: arrowhead frequency option cannot be given in percent.  Try another unit."):M(s)?(k=s.slice(0,s.length-1)/b,T=1/k,T=Math.floor(T),k=1/T):E(s)&&(k=(()=>A(s.slice(0,s.length-2),this._map)/b)(),T=1/k,T=Math.floor(T),k=1/T):(k=1/s,T=s),"allvertices"===i.frequency)y=(()=>{let x=[];for(var _=1;_<g.length;_++){let P=L.GeometryUtil.angle(this._map,g[N(_-1,g.length)],g[_])+180;x.push(P)}return x})(),C=g,C.shift();else if("endonly"===i.frequency&&g.length>=2)C=[g[g.length-1]],y=[L.GeometryUtil.angle(this._map,g[g.length-2],g[g.length-1])+180];else{C=[];let x=[];for(var D=0;D<T;D++){let _=L.GeometryUtil.interpolateOnLine(this._map,g,k*(D+1));_&&(x.push(_),C.push(_.latLng))}y=(()=>{let _=[];for(var P=0;P<x.length;P++){let I=L.GeometryUtil.angle(this._map,g[x[P].predecessor+1],g[x[P].predecessor]);_.push(I)}return _})()}let z=[];const V=(x,_={})=>{let P=_.yawn??i.yawn,I=L.GeometryUtil.destination(C[D],y[D]-P/2,x),F=L.GeometryUtil.destination(C[D],y[D]+P/2,x),R=[[I.lat,I.lng],[C[D].lat,C[D].lng],[F.lat,F.lng]],U=i.fill?L.polygon(R,{...o,..._}):L.polyline(R,{...o,..._});z.push(U)},$=(x,_={})=>{let P=x.slice(0,x.length-2),I=_.yawn??i.yawn,F=this._map.latLngToLayerPoint(C[D]),R=y[D],U=(180-R-I/2)*(Math.PI/180),H=(180-R+I/2)*(Math.PI/180),q=P*Math.sin(U),J=P*Math.cos(U),X=P*Math.sin(H),Y=P*Math.cos(H),tt={x:F.x+X,y:F.y+Y},et=this._map.layerPointToLatLng({x:F.x+q,y:F.y+J}),W=this._map.layerPointToLatLng(tt),Q=[[et.lat,et.lng],[C[D].lat,C[D].lng],[W.lat,W.lng]],nt=i.fill?L.polygon(Q,{...o,..._}):L.polyline(Q,{...o,..._});z.push(nt)};for(D=0;D<C.length;D++){let{perArrowheadOptions:_,...P}=i;if(_=_?_(D):{},_=Object.assign(P,j(_)),a=_.size??a,M(a))V(a.slice(0,a.length-1),_);else if(O(a)){let I=a.slice(0,a.length-1);V("endonly"===i.frequency&&i.proportionalToTotal?b*I/100:b/(h.length-1)*I/100,_)}else E(a)?$(i.size,_):console.error("Error: Arrowhead size unit not defined.  Check your arrowhead options.")}d.push(...z)});let p=L.layerGroup(d);return this._arrowheads=p,this},getArrowheads:function(){return this._arrowheads?this._arrowheads:console.error("Error: You tried to call '.getArrowheads() on a shape that does not have a arrowhead.  Use '.arrowheads()' to add a arrowheads before trying to call '.getArrowheads()'")},_buildGhosts:function({start:i,end:n}){if(i||n){let t=this.getLatLngs();t=Array.isArray(t[0])?t:[t];const o=t.map(a=>{const d=(()=>{let s=0;for(var m=0;m<a.length-1;m++)s+=this._map.distance(a[m],a[m+1]);return s})();if(i){let s=(()=>M(i)?Number(i.slice(0,i.length-1)):E(i)?A(Number(i.slice(0,i.length-2)),this._map):void 0)(),m=L.GeometryUtil.interpolateOnLine(this._map,a,s/d);(a=a.slice(-1===m.predecessor?1:m.predecessor+1,a.length)).unshift(m.latLng)}if(n){let s=(()=>M(n)?Number(n.slice(0,n.length-1)):E(n)?A(Number(n.slice(0,n.length-2)),this._map):void 0)(),m=L.GeometryUtil.interpolateOnLine(this._map,a,(d-s)/d);(a=a.slice(0,m.predecessor+1)).push(m.latLng)}return a});this._ghosts=L.polyline(o,{...this.options,color:"rgba(0,0,0,0)",stroke:0,smoothFactor:0,interactive:!1}),this._ghosts.addTo(this._map)}},deleteArrowheads:function(){this._arrowheads&&(this._arrowheads.remove(),delete this._arrowheads,delete this._arrowheadOptions,this._hatsApplied=!1),this._ghosts&&this._ghosts.remove()},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath(),this._hatsApplied&&(this.buildVectorHats(this._arrowheadOptions),this._map.addLayer(this._arrowheads)))},remove:function(){return this._arrowheads&&this._arrowheads.remove(),this._ghosts&&this._ghosts.remove(),this.removeFrom(this._map||this._mapToAdd)}}),L.LayerGroup.include({removeLayer:function(i){var n=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[n]&&(this._layers[n]._arrowheads&&this._layers[n]._arrowheads.remove(),this._map.removeLayer(this._layers[n])),delete this._layers[n],this},onRemove:function(i,n){for(var n in this._layers)this._layers[n]&&this._layers[n].remove();this.eachLayer(i.removeLayer,i)}}),L.Map.include({removeLayer:function(i){var n=L.Util.stamp(i);return i._arrowheads&&i._arrowheads.remove(),i._ghosts&&i._ghosts.remove(),this._layers[n]?(this._loaded&&i.onRemove(this),i.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(i.getAttribution()),delete this._layers[n],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this}}),L.GeoJSON.include({geometryToLayer:function(i,n){var m,u,p,h,t="Feature"===i.type?i.geometry:i,o=t?t.coordinates:null,a=[],d=n&&n.pointToLayer,s=n&&n.coordsToLatLng||L.GeoJSON.coordsToLatLng;if(!o&&!t)return null;switch(t.type){case"Point":return m=s(o),this._pointToLayer(d,i,m,n);case"MultiPoint":for(p=0,h=o.length;p<h;p++)m=s(o[p]),a.push(this._pointToLayer(d,i,m,n));return new L.FeatureGroup(a);case"LineString":case"MultiLineString":u=L.GeoJSON.coordsToLatLngs(o,"LineString"===t.type?0:1,s);var v=new L.Polyline(u,n);return n.arrowheads&&v.arrowheads(n.arrowheads),v;case"Polygon":case"MultiPolygon":return u=L.GeoJSON.coordsToLatLngs(o,"Polygon"===t.type?1:2,s),new L.Polygon(u,n);case"GeometryCollection":for(p=0,h=t.geometries.length;p<h;p++){var g=this.geometryToLayer({geometry:t.geometries[p],type:"Feature",properties:i.properties},n);g&&a.push(g)}return new L.FeatureGroup(a);default:throw new Error("Invalid GeoJSON object.")}},addData:function(i){var t,o,a,n=L.Util.isArray(i)?i:i.features;if(n){for(t=0,o=n.length;t<o;t++)((a=n[t]).geometries||a.geometry||a.features||a.coordinates)&&this.addData(a);return this}var d=this.options;if(d.filter&&!d.filter(i))return this;var s=this.geometryToLayer(i,d);return s?(s.feature=L.GeoJSON.asFeature(i),s.defaultOptions=s.options,this.resetStyle(s),d.onEachFeature&&d.onEachFeature(i,s),this.addLayer(s)):this},_pointToLayer:function(i,n,t,o){return i?i(n,t):new L.Marker(t,o&&o.markersInheritOptions&&o)}})},4930:(N,j,M)=>{var O,E,A;E=[M(8407)],void 0!==(A="function"==typeof(O=function(i){"use strict";return i.Polyline._flat=i.LineUtil.isFlat||i.Polyline._flat||function(n){return!i.Util.isArray(n[0])||"object"!=typeof n[0][0]&&typeof n[0][0]<"u"},i.GeometryUtil=i.extend(i.GeometryUtil||{},{distance:function(n,t,o){return n.latLngToLayerPoint(t).distanceTo(n.latLngToLayerPoint(o))},distanceSegment:function(n,t,o,a){var d=n.latLngToLayerPoint(t),s=n.latLngToLayerPoint(o),m=n.latLngToLayerPoint(a);return i.LineUtil.pointToSegmentDistance(d,s,m)},readableDistance:function(n,t){return"imperial"!==t?n>1e3?(n/1e3).toFixed(2)+" km":n.toFixed(1)+" m":(n*=1.09361)>1760?(n/1760).toFixed(2)+" miles":n.toFixed(1)+" yd"},belongsSegment:function(n,t,o,a){a=void 0===a?.2:a;var d=t.distanceTo(o);return(t.distanceTo(n)+n.distanceTo(o)-d)/d<a},length:function(n){var t=i.GeometryUtil.accumulatedLengths(n);return t.length>0?t[t.length-1]:0},accumulatedLengths:function(n){if("function"==typeof n.getLatLngs&&(n=n.getLatLngs()),0===n.length)return[];for(var t=0,o=[0],a=0,d=n.length-1;a<d;a++)t+=n[a].distanceTo(n[a+1]),o.push(t);return o},closestOnSegment:function(n,t,o,a){var d=n.getMaxZoom();d===1/0&&(d=n.getZoom());var s=n.project(t,d),m=n.project(o,d),u=n.project(a,d),p=i.LineUtil.closestPointOnSegment(s,m,u);return n.unproject(p,d)},closest:function(n,t,o,a){var d,u,p,h,v,s=1/0,m=null;if(t instanceof Array){if(t[0]instanceof Array&&"number"!=typeof t[0][0]){for(u=0;u<t.length;u++)(v=i.GeometryUtil.closest(n,t[u],o,a))&&v.distance<s&&(s=v.distance,m=v);return m}if(!(t[0]instanceof i.LatLng||"number"==typeof t[0][0]||"number"==typeof t[0].lat))return m;t=i.polyline(t)}if(!(t instanceof i.Polyline))return m;if(d=JSON.parse(JSON.stringify(t.getLatLngs().slice(0))),t instanceof i.Polygon){var g=function(k){if(i.Polyline._flat(k))k.push(k[0]);else for(var T=0;T<k.length;T++)g(k[T])};g(d)}if(i.Polyline._flat(d)){if(a){for(u=0,p=d.length;u<p;u++){var b=d[u];(h=i.GeometryUtil.distance(n,o,b))<s&&(s=h,(m=b).distance=h)}return m}for(u=0,p=d.length;u<p-1;u++){var C=d[u],y=d[u+1];(h=i.GeometryUtil.distanceSegment(n,o,C,y))<=s&&(s=h,(m=i.GeometryUtil.closestOnSegment(n,o,C,y)).distance=h)}return m}for(u=0;u<d.length;u++)(v=i.GeometryUtil.closest(n,d[u],o,a)).distance<s&&(s=v.distance,m=v);return m},closestLayer:function(n,t,o){for(var a=1/0,d=null,s=null,m=1/0,u=0,p=t.length;u<p;u++){var h=t[u];if(h instanceof i.LayerGroup){var v=i.GeometryUtil.closestLayer(n,h.getLayers(),o);v.distance<a&&(a=v.distance,d=v)}else"function"==typeof h.getLatLng?(s=h.getLatLng(),m=i.GeometryUtil.distance(n,o,s)):(s=i.GeometryUtil.closest(n,h,o))&&(m=s.distance),m<a&&(a=m,d={layer:h,latlng:s,distance:m})}return d},nClosestLayers:function(n,t,o,a){if((a="number"==typeof a?a:t.length)<1||t.length<1)return null;for(var s,m,d=[],u=0,p=t.length;u<p;u++){var h=t[u];if(h instanceof i.LayerGroup){var v=i.GeometryUtil.closestLayer(n,h.getLayers(),o);d.push(v)}else"function"==typeof h.getLatLng?(m=h.getLatLng(),s=i.GeometryUtil.distance(n,o,m)):(m=i.GeometryUtil.closest(n,h,o))&&(s=m.distance),d.push({layer:h,latlng:m,distance:s})}return d.sort(function(g,b){return g.distance-b.distance}),d.length>a?d.slice(0,a):d},layersWithin:function(n,t,o,a){a="number"==typeof a?a:1/0;for(var d=[],s=null,m=0,u=0,p=t.length;u<p;u++){var h=t[u];"function"==typeof h.getLatLng?(s=h.getLatLng(),m=i.GeometryUtil.distance(n,o,s)):(s=i.GeometryUtil.closest(n,h,o))&&(m=s.distance),s&&m<a&&d.push({layer:h,latlng:s,distance:m})}return d.sort(function(g,b){return g.distance-b.distance})},closestLayerSnap:function(n,t,o,a,d){a="number"==typeof a?a:1/0,d="boolean"!=typeof d||d;var s=i.GeometryUtil.closestLayer(n,t,o);if(!s||s.distance>a)return null;if(d&&"function"==typeof s.layer.getLatLngs){var m=i.GeometryUtil.closest(n,s.layer,s.latlng,!0);m.distance<a&&(s.latlng=m,s.distance=i.GeometryUtil.distance(n,m,o))}return s},interpolateOnPointSegment:function(n,t,o){return i.point(n.x*(1-o)+o*t.x,n.y*(1-o)+o*t.y)},interpolateOnLine:function(n,t,o){var a=(t=t instanceof i.Polyline?t.getLatLngs():t).length;if(a<2)return null;if(0===(o=Math.max(Math.min(o,1),0)))return{latLng:t[0]instanceof i.LatLng?t[0]:i.latLng(t[0]),predecessor:-1};if(1==o)return{latLng:t[t.length-1]instanceof i.LatLng?t[t.length-1]:i.latLng(t[t.length-1]),predecessor:t.length-2};var d=n.getMaxZoom();d===1/0&&(d=n.getZoom());for(var s=[],m=0,u=0;u<a;u++)s[u]=n.project(t[u],d),u>0&&(m+=s[u-1].distanceTo(s[u]));var p=m*o,h=0,v=0;for(u=0;v<p;u++)h=v,v+=(g=s[u]).distanceTo(b=s[u+1]);if(null==g&&null==b){var g=s[0],b=s[1];u=1}var y=i.GeometryUtil.interpolateOnPointSegment(g,b,v-h!=0?(p-h)/(v-h):0);return{latLng:n.unproject(y,d),predecessor:u-1}},locateOnLine:function(n,t,o){var a=t.getLatLngs();if(o.equals(a[0]))return 0;if(o.equals(a[a.length-1]))return 1;for(var d=i.GeometryUtil.closest(n,t,o,!1),s=i.GeometryUtil.accumulatedLengths(a),m=s[s.length-1],u=0,p=!1,h=0,v=a.length-1;h<v;h++){var g=a[h];if(u=s[h],i.GeometryUtil.belongsSegment(d,g,a[h+1],.001)){u+=g.distanceTo(d),p=!0;break}}if(!p)throw"Could not interpolate "+o.toString()+" within "+t.toString();return u/m},reverse:function(n){return i.polyline(n.getLatLngs().slice(0).reverse())},extract:function(n,t,o,a){if(o>a)return i.GeometryUtil.extract(n,i.GeometryUtil.reverse(t),1-o,1-a);o=Math.max(Math.min(o,1),0),a=Math.max(Math.min(a,1),0);var d=t.getLatLngs(),s=i.GeometryUtil.interpolateOnLine(n,t,o),m=i.GeometryUtil.interpolateOnLine(n,t,a);if(o==a)return[i.GeometryUtil.interpolateOnLine(n,t,a).latLng];-1==s.predecessor&&(s.predecessor=0),-1==m.predecessor&&(m.predecessor=0);var p=d.slice(s.predecessor+1,m.predecessor+1);return p.unshift(s.latLng),p.push(m.latLng),p},isBefore:function(n,t){if(!t)return!1;var o=n.getLatLngs(),a=t.getLatLngs();return o[o.length-1].equals(a[0])},isAfter:function(n,t){if(!t)return!1;var o=n.getLatLngs(),a=t.getLatLngs();return o[0].equals(a[a.length-1])},startsAtExtremity:function(n,t){if(!t)return!1;var o=n.getLatLngs(),a=t.getLatLngs(),d=o[0];return d.equals(a[0])||d.equals(a[a.length-1])},computeAngle:function(n,t){return 180*Math.atan2(t.y-n.y,t.x-n.x)/Math.PI},computeSlope:function(n,t){var o=(t.y-n.y)/(t.x-n.x);return{a:o,b:n.y-o*n.x}},rotatePoint:function(n,t,o,a){var d=n.getMaxZoom();d===1/0&&(d=n.getZoom());var s=o*Math.PI/180,m=n.project(t,d),u=n.project(a,d),p=Math.cos(s)*(m.x-u.x)-Math.sin(s)*(m.y-u.y)+u.x,h=Math.sin(s)*(m.x-u.x)+Math.cos(s)*(m.y-u.y)+u.y;return n.unproject(new i.Point(p,h),d)},bearing:function(n,t){var o=Math.PI/180,a=n.lat*o,d=t.lat*o,s=n.lng*o,m=t.lng*o,u=Math.sin(m-s)*Math.cos(d),p=Math.cos(a)*Math.sin(d)-Math.sin(a)*Math.cos(d)*Math.cos(m-s),h=(180*Math.atan2(u,p)/Math.PI+360)%360;return h>=180?h-360:h},destination:function(n,t,o){t=(t+360)%360;var a=Math.PI/180,d=180/Math.PI,s=6378137,m=n.lng*a,u=n.lat*a,p=t*a,h=Math.sin(u),v=Math.cos(u),g=Math.cos(o/s),b=Math.sin(o/s),C=Math.asin(h*g+v*b*Math.cos(p)),y=m+Math.atan2(Math.sin(p)*b*v,g-h*Math.sin(C));return i.latLng([C*d,y=(y*=d)>180?y-360:y<-180?y+360:y])},angle:function(n,t,o){var a=n.latLngToContainerPoint(t),d=n.latLngToContainerPoint(o),s=180*Math.atan2(d.y-a.y,d.x-a.x)/Math.PI+90;return s+(s<0?360:0)},destinationOnSegment:function(n,t,o,a){var d=i.GeometryUtil.angle(n,t,o),s=i.GeometryUtil.destination(t,d,a);return i.GeometryUtil.closestOnSegment(n,s,t,o)}}),i.GeometryUtil})?O.apply(j,E):O)&&(N.exports=A)}}]);